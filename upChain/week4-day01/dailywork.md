# 基于NFTpermit添加NFT离线签名

➤ 签名 NFT 上架信息
➤ 使⽤离线签名和验证存储NFT上架， 展⽰最新的 NFT 上架清单
➤ 完善 NFTMarket合约，使⽤ETH买⼊NFT
➤ Option：在TheGraph中记录NFT记录，并在⽹页中展⽰NFT交易动态
挑战：https://decert.me/quests/d9c6e975-4742-4f81-89fa-5986b61062ea

## 题解思路：
1、给原本的合约的buy方法中添加一个验证方法，验证中恢复出来的地址应该就是签名者本身的地址。这样一切就说的通。
2、如果恢复出来的地址不对，则说明卖家的签名信息有误。将不可以进行售卖。

### 测试用例步骤：

1、部署符合ERC2612的 Token, 这个在上面已经完成了，token地址 ' 0x3c510705cdbb9c2d8c6A68A44256fb331D1EDB56 '

2、部署这个Token的地址是我的主网地址 ' 0x2b754dEF498d4B6ADada538F01727Ddf67D91A7D ' 将Token添加到钱包中，本来发行了100个，目前主账户钱包中还有80个。

3、第二个账户地址 ' 0x922dB1A931327CA2680343eD2d5E4541669701e9 ' 目前有 10 个 Token。

4、部署ERC721NFT合约，还是使用我的主账户部署，部署之后的地址：' 0xE7741Ca16f8399D06FC8069184a742E59F3e9bF5 ' name NFTPermit

5、给自己的主账户 mint 一个NFT, tokenId 初始值为 1，

6、mint之后，检查NFT的所有权、数量等等信息。看看是否符合预期。

7、开始部署比较重要的 NFTmarketpermit 合约，这个合约, 还是比较重要的。我用第三个账户进行部署。第三个账户的地址 ' 0x843E582a8E439E770D18553942bAF1D3f10b0Ff1 '

8、部署marketpermit合约，入参是TOKEN20 和 NFT地址, 并测试上架和取消上架。

——————————————————————————————————————————————————————————————————————

最小化的函数验证：
1、我已经将最小的验证函数部署好了地址： ' 0xA3ea2b4444D81F52309a71Ef625823567700C2d1 '
2、这个是使用账号3部署的，我生成签名的时候，应该用账号3给账号1签名，然后账号2携带着这个签名来调用这个函数，如果能够解析出来的地址等于账号3的地址，说明这个函数没有问题。


